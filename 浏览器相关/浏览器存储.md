# 浏览器存储

## Cookie

Cookie 作为最老牌的存储型缓存，其诞生之初其实并不是为了提供浏览器存储的功能，而是为了辨别用户身份，实现页面间状态的维持和传递，Cookie 的存储空间很小，不能超过 4KB，因此这一缺点也限制了它用于存储较大容量数据的能力。

利用 Cookie 无法跨域携带的特点可以在 CDN 域名上有所作为。假如 CDN 资源和主站采用了同样的域名，那么必然会造成因 Cookie 传输带来的巨大性能浪费，相反可以将 CDN 的域名与主站区分开来来规避这一问题。比如掘金的 CDN 域名为 <https://lf3-cdn-tos.bytescm.com>，而主站的域名为 <https://juejin.cn>

Cookie的存储是以域名形式进行区分的，不同的域名下存储的Cookie是独立的，可以设置Cookie生效的域，能够操作的Cookie是当前域以及当前域下的所有子域，Cookie是紧跟域名的，同一个域名下的所有请求都会携带Cookie，过量的Cookie也会带来巨大的性能浪费

Cookie参与服务端通信，携带在请求头中

存储的数据为键值对，值为字符串，如果是对象会被stringify

## Web Storage

在验证用户身份及维持状态方面，Cookie 有明显的特点和优势，但在存储数据方面并不很友好，相反 Web Storage 在这方面却有显著的优势

Web Storage 作为 HTML5 推出的浏览器存储机制，其又可分为 Session Storage 和 Local Storage，两者相辅相成
两者的区别在于生命周期和作用域不同：

- 生命周期：Local Storage 是持久化的本地存储，存储在其中的数据是永远不会过期的，使其消失的唯一办法是手动删除；而 Session Storage 是临时性的本地存储，它是会话级别的存储，当会话结束（页面被关闭）时，存储内容也随之被释放
- 作用域：Local Storage、Session Storage 和 Cookie 都遵循同源策略。但 Session Storage 特别的一点在于，即便是相同域名下的两个页面，只要它们不在同一个浏览器窗口中打开，那么它们的 Session Storage 内容便无法共享

Web Storage 与 Cookie 相比存储大小得到了明显的提升，一般为 2.5-10M 之间（各家浏览器不同），这容量对于用于网页数据存储来说已经十分充足

Web Storage不参与服务端通信

存储的数据为键值对，值为字符串，如果是对象会被stringify

## IndexedDB

IndexedDB 是一个运行在浏览器上的非关系型数据库，是一个大规模的 NoSQL 存储系统，它几乎可以存储浏览器中的任何数据内容，包括二进制数据（ArrayBuffer 对象和 Blob 对象），其可以存储不少于 250M 的数据
[浏览器数据库 IndexedDB 入门教程](http://www.ruanyifeng.com/blog/2018/07/indexeddb.html)
